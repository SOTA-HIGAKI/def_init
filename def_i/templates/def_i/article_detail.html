{% extends 'def_i/base.html' %}
{% load static %}
{% load sass_tags %}
{% block extra_style %}
<link rel="stylesheet" href="{% sass_src 'def_i/css/article_detail.scss' %}">
<link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
{% endblock extra_style %}
{% block menubar %}
{% endblock menubar %}
{% block contents %}
<h1>{{contents.title}}</h1>
<div class="like-outer">
{% include 'def_i/like.html' %}
</div>
<p>投稿者：{{contents.poster}}</p>
<p class="article-contents">{{contents.content}}</p>
<a href="{% url 'article_talk' contents.pk %}"><p>コメントを書く<span>({{comments}})</span></p></a>
<a href="{% url 'article_feed' %}"><p>記事フィードに戻る</p></a>
{% endblock contents %}
{% block javascript %}
<script>
    $(document).ready(function(e){
        $(document).on('click','#like',function(e){
            e.preventDefault(); //button&POSTに対しては効きません．．．．
            $.ajax({
                type:'GET',
                url:"{% url 'like' contents.pk %}",
                // data:{
                //     'article_id':$this.attr('name'),
                //     'csrfmiddlewaretoken':'{{ csrf_token }}',
                // }
                // dataType:'json',
                success:function(response){
                    selector = document.getElementById('like')
                    if(response.liked){
                        $(selector).html("<i class='fas fa-lg fa-heart'></i>")
                    }
                    else{
                        $(selector).html("<i class='far fa-lg fa-heart'></i>")
                    }
                    selector2 = document.getElementById('count')
                    $(selector2).text(response.count)
                }
            })
        })
    })
</script>
{% endblock javascript %}